"0","selectivv[[3]] |>"
"0","  count(category, apps, group, period, wt = number_of_users) |>"
"0","  spread(group, n) |>"
"0","  mutate(fua = `Functional area` - Cities, "
"0","         woj = Voivodeship - `Functional area`) |>"
"0","  select(category, apps, period, cities = Cities, fua, woj) |>"
"0","  gather(geo, val, -apps, -period, -category) |>"
"0","  mutate(geo = factor(geo, c(""cities"", ""fua"", ""woj""),"
"0","                      c(""Cities"", ""Functional UAs"", ""Provinces"")),"
"0","         category = ifelse(apps == ""Uber"", ""Uber & Uber Eats"", category),"
"0","         category  = factor(category, c(""Transportation"", ""Delivery"", ""Uber & Uber Eats""))) |>"
"0","  group_by(apps, geo) |>"
"0","  mutate(index = val/val[1],"
"0","         diff = val-val[1],"
"0","         apps = factor(apps, c(""Uber"", ""Bolt Driver"", ""iTaxi"", ""FREE NOW"","
"0","                               ""Takeaway"", ""Wolt"", ""Glover"",  ""Bolt Courier""))) |>"
"0","  ggplot(data = _, aes(x = as.factor(period), y = diff/1000, group = apps, color = apps)) +"
"0","  geom_line() +"
"0","  geom_point() + "
"0","  scale_color_brewer(type = ""qual"", palette = ""Dark2"") +  "
"0","  facet_grid(category ~ geo, scales = ""free_y"") +"
"0","  geom_hline(yintercept = 0, linetype = ""dashed"") +"
"0","  labs(x = ""The reference period (t0=2018.1)"", "
"0","       y = ""Change in the number of users\n(in thousands)"", color = ""Apps"") +"
"0","  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),"
"0","        legend.position = ""bottom"","
"0","        legend.direction = ""horizontal"") +"
"0","  guides(color = guide_legend(nrow = 2, byrow = TRUE)) ->  p1b"
"0",""
"0","p1b"
